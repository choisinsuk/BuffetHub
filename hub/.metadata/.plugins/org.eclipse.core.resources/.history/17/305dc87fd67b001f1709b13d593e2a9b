package com.hub.config;

import org.modelmapper.ModelMapper;
import org.modelmapper.convention.MatchingStrategies;
import org.springframework.context.annotation.Bean;
import org.springframework.context.annotation.Configuration;

@Configuration
public class RootConfig {

	@Bean
	public ModelMapper getMapper() {
		ModelMapper modelMapper = new ModelMapper();
		modelMapper.getConfiguration().setFieldMatchingEnabled(true)
		.setFieldAccessLevel(org.modelmapper.config.Configuration.AccessLevel.PRIVATE)
		.setMatchingStrategy(MatchingStrategies.LOOSE);
		
		 // ReserveDTO to Reserve 엔티티 커스텀 매핑 설정
        modelMapper.typeMap(ReserveDTO.class, Reserve.class).addMappings(mapper -> {
            // ReserveDTO의 ur_id를 User 객체로 매핑
            mapper.map(src -> {
                User user = new User();
                user.setUr_id(src.getUr_id()); // DTO의 ur_id를 User 엔티티로 변환
                return user;
            }, Reserve::setUser);
            
            // ReserveDTO의 bv_nb를 BuffetVoucher 객체로 매핑
            mapper.map(src -> {
                BuffetVoucher voucher = new BuffetVoucher();
                voucher.setBv_nb(src.getBv_nb()); // DTO의 bv_nb를 BuffetVoucher로 변환
                return voucher;
            }, Reserve::setVoucher);
        });
		
		return modelMapper;
	}
}
